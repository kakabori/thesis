(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     12600,        317]
NotebookOptionsPosition[     11873,        288]
NotebookOutlinePosition[     12289,        304]
CellTagsIndexPosition[     12246,        301]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", "1.175"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"func", "[", 
   RowBox[{"\[Theta]B_", ",", "x0_", ",", "am_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ArcTan", "[", 
      FractionBox["x0", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"w", "^", "2"}], "+", 
         RowBox[{"am", "^", "2"}]}], "]"}]], "]"}], "*", 
     FractionBox["4", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"w", "^", "2"}], "+", 
        RowBox[{"am", "^", "2"}]}], "]"}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"w", ",", "0", ",", "\[Theta]B"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "[", "am_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", "\[Pi]"}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       FractionBox["a", 
        RowBox[{
         RowBox[{"a", "^", "2"}], "+", 
         RowBox[{"am", "^", "2"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], ")"}], "^", 
    RowBox[{"-", "1"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"th", "[", "qz_", "]"}], ":=", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"qz", "/", 
    RowBox[{"(", 
     RowBox[{"4", "\[Pi]"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"norm", "[", 
     RowBox[{"0.05", "*", 
      RowBox[{"\[Pi]", "/", "180"}]}], "]"}], "*", 
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"th", "[", "qz", "]"}], ",", 
      RowBox[{"1.4", "*", 
       RowBox[{"\[Pi]", "/", "180"}]}], ",", 
      RowBox[{"0.05", "*", 
       RowBox[{"\[Pi]", "/", "180"}]}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"qz", ",", "0.05", ",", "0.7"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvactQIL39SvHM8G5kiBa5i5XKogOFLPPBtFHn8yr
BtGX6gPngukdmovAtIXlNhC9KNZ8H4jO1FwApsuL41z5gXTWMl83EC0Q4xMm
AqSjZPOiQbTWMfN4EP1E3hpMB717ng2i5xlurgbRDA1rGeNANMMkZggdw5cG
pn/zg+kGo3gIXQ2hGX4lQ/jNqRC+34R0MF08HUw3WLVngGneLjDNIL0pG0xv
2AqmG+T2Q/j1h0H07pxbHHuB9HvmeE4QbWT5OB5EKyU+A9MAodKT9g==
  "]],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0.1, 0.3},
  Method->{},
  PlotRange->{{0.05, 0.7}, {0.3013724607351827, 0.5058379466049983}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.612896411804376*^9, 3.612896491788354*^9, {3.612896592256329*^9, 
   3.612896604381298*^9}, {3.612896644868153*^9, 3.612896694828944*^9}, 
   3.612896761170504*^9, {3.612899889206202*^9, 3.612899894738291*^9}, {
   3.612910264949522*^9, 3.61291030355934*^9}, 3.612910334687596*^9, 
   3.612910437855104*^9, {3.612910481409068*^9, 3.612910560437424*^9}, 
   3.613060953671875*^9, {3.61306113709375*^9, 3.61306115121875*^9}, {
   3.61307762159375*^9, 3.613077634671875*^9}, 3.6130782709375*^9, {
   3.613078306734375*^9, 3.613078318796875*^9}, {3.613080722625*^9, 
   3.613080733359375*^9}, 3.613080766734375*^9, {3.6130826858125*^9, 
   3.613082709*^9}, 3.613089311390625*^9, 3.613255696811926*^9, 
   3.613255757716513*^9, 3.613256449994808*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<~/mosaic_correction.dat\>\"", ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qz", ",", 
       RowBox[{
        RowBox[{"norm", "[", 
         RowBox[{"0.05", "*", 
          RowBox[{"\[Pi]", "/", "180"}]}], "]"}], "*", 
        RowBox[{"func", "[", 
         RowBox[{
          RowBox[{"th", "[", "qz", "]"}], ",", 
          RowBox[{"1.4", "*", 
           RowBox[{"\[Pi]", "/", "180"}]}], ",", 
          RowBox[{"0.05", "*", 
           RowBox[{"\[Pi]", "/", "180"}]}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"qz", ",", "0.05", ",", "0.7", ",", "0.001"}], "}"}]}], "]"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.6130893331875*^9, 3.613089439296875*^9}, {
  3.613089552328125*^9, 3.61308955578125*^9}, {3.613256381151503*^9, 
  3.613256381587297*^9}, {3.613256413028412*^9, 3.613256428706024*^9}}],

Cell[BoxData["\<\"~/mosaic_correction.dat\"\>"], "Output",
 CellChangeTimes->{3.613089450828125*^9, 3.613089566796875*^9, 
  3.613256406173289*^9, 3.613256444556759*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"am", "=", 
   RowBox[{"0.05", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tb", "=", 
   RowBox[{"90", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"1.4", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "[", "am", "]"}], "*", 
  RowBox[{"func", "[", 
   RowBox[{"tb", ",", "x0", ",", "am"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.612910183358657*^9, {3.61291021659284*^9, 3.612910216997625*^9}, {
   3.613060954453125*^9, 3.6130610654375*^9}, {3.613061104*^9, 
   3.6130611146875*^9}, {3.6130611666875*^9, 3.61306116725*^9}, {
   3.613077550859375*^9, 3.613077565015625*^9}, {3.61307764175*^9, 
   3.613077650046875*^9}, {3.6130776975*^9, 3.6130776983125*^9}, {
   3.613077828828125*^9, 3.613077873859375*^9}, {3.613077926390625*^9, 
   3.61307794*^9}, {3.61307829353125*^9, 3.61307829865625*^9}, {
   3.613079721921875*^9, 3.6130797935*^9}, {3.61307986296875*^9, 
   3.61307987534375*^9}, {3.61308266675*^9, 3.6130826735625*^9}, {
   3.613082720859375*^9, 3.61308277828125*^9}, {3.613083300828125*^9, 
   3.613083305859375*^9}, {3.6130842810625*^9, 3.613084295265625*^9}, {
   3.613089144140625*^9, 3.61308914634375*^9}, {3.613255815438061*^9, 
   3.613255825578745*^9}, {3.613255892082125*^9, 3.613255912794398*^9}, {
   3.613256088475235*^9, 3.613256106116902*^9}, {3.613256261130544*^9, 
   3.613256293361645*^9}}],

Cell[BoxData["0.5357541397632349`"], "Output",
 CellChangeTimes->{{3.612910211566806*^9, 3.612910217611407*^9}, {
   3.6130610001875*^9, 3.61306106590625*^9}, {3.613061106796875*^9, 
   3.6130611156875*^9}, {3.613061156375*^9, 3.613061168*^9}, {
   3.6130775530625*^9, 3.613077565859375*^9}, {3.613077625328125*^9, 
   3.613077650984375*^9}, 3.613077699171875*^9, 3.613077833484375*^9, 
   3.613077874890625*^9, {3.613077927421875*^9, 3.61307794059375*^9}, {
   3.613078276765625*^9, 3.6130783196875*^9}, {3.613079723390625*^9, 
   3.613079795140625*^9}, {3.6130798575625*^9, 3.613079876328125*^9}, {
   3.613082657546875*^9, 3.61308273021875*^9}, {3.6130827609375*^9, 
   3.613082779453125*^9}, {3.613083301640625*^9, 3.6130833068125*^9}, {
   3.613084283734375*^9, 3.61308429665625*^9}, 3.613089148515625*^9, {
   3.613255808201685*^9, 3.613255826114005*^9}, {3.613255895268131*^9, 
   3.613255913423166*^9}, {3.613256089288142*^9, 3.613256106781732*^9}, {
   3.613256262806555*^9, 3.613256293958164*^9}, 3.613256661503777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"am", "=", 
   RowBox[{"0.1", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tb", "=", 
   RowBox[{"4", "*", "0.58", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"1.4", "*", 
    RowBox[{"\[Pi]", "/", "180"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "[", "am", "]"}], "*", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"tb", ",", "x0", ",", "am"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"norm", "[", "am", "]"}], "*", 
     RowBox[{"func", "[", 
      RowBox[{"tb", ",", 
       RowBox[{"45", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}], ",", "am"}], "]"}]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.61307776596875*^9, 3.613077816703125*^9}, {
  3.6130800306875*^9, 3.613080045890625*^9}, {3.613080365328125*^9, 
  3.61308036571875*^9}, {3.6130826314375*^9, 3.61308265115625*^9}, {
  3.6130830264375*^9, 3.6130830760625*^9}, {3.613083327390625*^9, 
  3.613083366203125*^9}, {3.6130834281875*^9, 3.613083444953125*^9}, {
  3.613083548453125*^9, 3.613083549109375*^9}, {3.6130837999375*^9, 
  3.6130838253125*^9}, {3.613084058390625*^9, 3.6130840633125*^9}, {
  3.613084266015625*^9, 3.613084270515625*^9}}],

Cell[BoxData["0.7788107077385763`"], "Output",
 CellChangeTimes->{{3.613077819609375*^9, 3.613077837140625*^9}, 
   3.613077877171875*^9, {3.61307792946875*^9, 3.613077942859375*^9}, 
   3.613078279765625*^9, {3.61307972575*^9, 3.613079799046875*^9}, {
   3.613080039765625*^9, 3.613080046859375*^9}, 3.613080366484375*^9, 
   3.613082651953125*^9, {3.61308302815625*^9, 3.613083076828125*^9}, {
   3.613083335921875*^9, 3.61308336678125*^9}, {3.613083430140625*^9, 
   3.613083445734375*^9}, 3.613083550546875*^9, {3.613083803203125*^9, 
   3.613083827140625*^9}, {3.61308405915625*^9, 3.613084064046875*^9}, {
   3.613084267578125*^9, 3.61308427115625*^9}}]
}, Open  ]]
},
WindowSize->{972, 749},
WindowMargins->{{195, Automatic}, {Automatic, 40}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Linux x86 (32-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 2231, 67, 179, "Input"],
Cell[2813, 91, 3296, 60, 284, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6146, 156, 910, 23, 77, "Input"],
Cell[7059, 181, 169, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7265, 188, 1542, 32, 99, "Input"],
Cell[8810, 222, 1029, 14, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9876, 241, 1319, 33, 99, "Input"],
Cell[11198, 276, 659, 9, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
